<!DOCTYPE html>
<html lang="en" >

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">


<meta property="og:title" content="" />
<meta property="og:description" content="Installation A. Pre-requisite  Required kernel version 5.0.0-23-generic. This request is from the module gtp5g that we has used. Any more details please check here
# Check kernel version $ uname -r 5.0.0-23-generic   Require go language
 If another version of Go is installed  Please remove the previous Go version  sudo rm -rf /usr/local/go   Install Go 1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://free5gc.org/installations/stage-3-installation/" />




<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content=""/>
<meta name="twitter:description" content="Installation A. Pre-requisite  Required kernel version 5.0.0-23-generic. This request is from the module gtp5g that we has used. Any more details please check here
# Check kernel version $ uname -r 5.0.0-23-generic   Require go language
 If another version of Go is installed  Please remove the previous Go version  sudo rm -rf /usr/local/go   Install Go 1."/>
<meta name="generator" content="Hugo 0.79.1" />

    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "",
  "url": "https://free5gc.org/installations/stage-3-installation/",
  "wordCount": "336",
  "datePublished": "0001-01-01T00:00:00+00:00",
  "author": {
    "@type": "Person",
    "name": "Your Name"
  }
}
</script>



    <link rel="canonical" href="https://free5gc.org/installations/stage-3-installation/">

    <title> | free5GC</title>

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">

    <!-- combined, minified CSS -->
    
    <link href="https://free5gc.org/css/bootstrap-icons.0568af55d343ad2fc9c221a17a15697dc5ef49add4551c5eb3e59d7582385228.css" rel="stylesheet">
    
    <link href="https://free5gc.org/css/style.73f0736b85bdf48090ed384697200a968c025d194f60717e37a515c4c87a8893.css" rel="stylesheet">

    <!-- minified base javascript -->
    
    <script defer src="https://free5gc.org/js/base.e5993f7509e480925eff41173b2176d6d85ef3df70ad0388d9275d09f0c3d966.js" crossorigin="anonymous"></script>

    

  </head>

  <body>

    
    <header class="d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white border-bottom shadow-sm">
      <p class="h5 my-0 me-md-auto fw-normal">
        <a class="nav-link " href="https://free5gc.org">
          <img src="/img/free5GC.png" width="217" height="51">
        </a>
      </p>
      <nav class="btn-group" role="group" aria-label="Basic outlined example">
          
          <a class="btn btn-outline-primary"
             href="/" title="Home">Home</a>
          
        
          
          <a class="btn btn-outline-primary"
             href="/roadmap/" title="Roadmap">Roadmap</a>
          
        
          
          <div id="btn-group-install" class="btn-group" role="group">
            <button type="button"
                    class="btn btn-outline-primary dropdown-toggle active"
                    data-bs-toggle="dropdown" aria-expanded="false">
              Installations
            </button>
            <ul class="dropdown-menu" aria-labelledby="btn-group-install">
              
              <li><a class="dropdown-item"
                     
                     title="Stage 1: Cluster"
                     href="/installations/stage-1-cluster/">Stage 1: Cluster</a></li>
              
              <li><a class="dropdown-item"
                     
                     title="Stage 1: All-in-one"
                     href="/installations/stage-1-all-in-one/">Stage 1: All-in-one</a></li>
              
              <li><a class="dropdown-item"
                     
                     title="Stage 2: Standalone 5G"
                     href="/installations/stage-2-standalone-5g/">Stage 2: Standalone 5G</a></li>
              
              <li><a class="dropdown-item"
                     
                     title="Stage 3: free5GC"
                     href="/installations/stage-3/">Stage 3: free5GC</a></li>
              
            </ul>
          </div>
          
        
          
          <a class="btn btn-outline-primary"
             href="/membership/" title="Membership">Membership</a>
          
        
          
          <a class="btn btn-outline-primary"
             href="/contactus/" title="Contact Us">Contact Us</a>
          
        
          
          <div id="btn-group-more" class="btn-group" role="group">
            <button type="button"
                    class="btn btn-outline-primary dropdown-toggle"
                    data-bs-toggle="dropdown" aria-expanded="false">
              More
            </button>
            <ul class="dropdown-menu" aria-labelledby="btn-group-more">
              
              <li><a class="dropdown-item"
                     target="_blank"
                     title="Download"
                     href="https://github.com/free5gc/free5gc">Download</a></li>
              
              <li><a class="dropdown-item"
                     target="_blank"
                     title="Youtube"
                     href="https://www.youtube.com/channel/UCywP5Acj50GlhSxZTJXlqtw/videos">Youtube</a></li>
              
              <li><a class="dropdown-item"
                     target="_blank"
                     title="free5GC Forum"
                     href="https://forum.free5gc.org/">free5GC Forum</a></li>
              
              <li><a class="dropdown-item"
                     
                     title="History"
                     href="/history/">History</a></li>
              
            </ul>
          </div>
          
        
      </nav>
    </header>
    

    <div class="container-fluid mx-auto" style="max-width: 960px;">

      


<article class="blog-post">
  <header>
    <h2 class="blog-post-title" dir="auto"><a href="https://free5gc.org/installations/stage-3-installation/"></a></h2>
    <p class="blog-post-meta">

</p>
  </header>
  <h2 id="installation">Installation</h2>
<h3 id="a-pre-requisite">A. Pre-requisite</h3>
<ol start="0">
<li>
<p>Required kernel version <code>5.0.0-23-generic</code>. This request is from the module
<a href="https://github.com/PrinzOwO/gtp5g">gtp5g</a> that we has used. Any more details
please check <a href="https://github.com/PrinzOwO/gtp5g">here</a></p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash"><span style="color:#60a0b0;font-style:italic"># Check kernel version</span>
$ uname -r
5.0.0-23-generic
</code></pre></div></li>
<li>
<p>Require go language</p>
<ul>
<li>If another version of Go is installed
<ul>
<li>Please remove the previous Go version
<ul>
<li><code>sudo rm -rf /usr/local/go</code></li>
</ul>
</li>
<li>Install Go 1.14.4
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">wget https://dl.google.com/go/go1.14.4.linux-amd64.tar.gz
sudo tar -C /usr/local -zxvf go1.14.4.linux-amd64.tar.gz
</code></pre></div></li>
</ul>
</li>
<li>Clean installation
<ul>
<li>Install Go 1.14.4
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">wget https://dl.google.com/go/go1.14.4.linux-amd64.tar.gz
sudo tar -C /usr/local -zxvf go1.14.4.linux-amd64.tar.gz
mkdir -p ~/go/<span style="color:#666">{</span>bin,pkg,src<span style="color:#666">}</span>
<span style="color:#007020">echo</span> <span style="color:#4070a0">&#39;export GOPATH=$HOME/go&#39;</span> &gt;&gt; ~/.bashrc
<span style="color:#007020">echo</span> <span style="color:#4070a0">&#39;export GOROOT=/usr/local/go&#39;</span> &gt;&gt; ~/.bashrc
<span style="color:#007020">echo</span> <span style="color:#4070a0">&#39;export PATH=$PATH:$GOPATH/bin:$GOROOT/bin&#39;</span> &gt;&gt; ~/.bashrc
<span style="color:#007020">source</span> ~/.bashrc
</code></pre></div></li>
</ul>
</li>
</ul>
</li>
<li>
<p>Required packages for control plane</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">sudo apt -y update
sudo apt -y install mongodb wget git
sudo systemctl start mongodb
</code></pre></div></li>
<li>
<p>Required packages for user plane</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">sudo apt -y update
sudo apt -y install git gcc cmake autoconf libtool pkg-config libmnl-dev libyaml-dev
go get -u github.com/sirupsen/logrus
</code></pre></div></li>
<li>
<p>Network Setting</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">sudo sysctl -w net.ipv4.ip_forward<span style="color:#666">=</span><span style="color:#40a070">1</span>
sudo iptables -t nat -A POSTROUTING -o &lt;dn_interface&gt; -j MASQUERADE
sudo systemctl stop ufw
</code></pre></div></li>
</ol>
<h3 id="b-install-control-plane-entities">B. Install Control Plane Entities</h3>
<ol>
<li>
<p>Clone free5GC project</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash"><span style="color:#007020">cd</span> ~
git clone --recursive -b v3.0.3 -j <span style="color:#4070a0">`</span>nproc<span style="color:#4070a0">`</span> https://github.com/free5gc/free5gc.git
<span style="color:#007020">cd</span> free5gc
</code></pre></div><p>(Optional) If you want to use the nightly version, runs:</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash"><span style="color:#007020">cd</span> ~/free5gc
git checkout master
git submodule sync
git submodule update --init --jobs <span style="color:#4070a0">`</span>nproc<span style="color:#4070a0">`</span>
git submodule foreach git checkout master
git submodule foreach git pull --jobs <span style="color:#4070a0">`</span>nproc<span style="color:#4070a0">`</span>
</code></pre></div></li>
<li>
<p>Run the script to install dependent packages</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash"><span style="color:#007020">cd</span> ~/free5gc
go mod download
</code></pre></div><p><strong>In step 2, the folder name should remain free5gc. Please do not modify it or the compilation would fail.</strong></p>
</li>
<li>
<p>Compile network function services in <code>free5gc</code> individually, e.g. AMF (redo this step for each NF), or</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash"><span style="color:#007020">cd</span> ~/free5gc
go build -o bin/amf -x src/amf/amf.go
</code></pre></div><p><strong>To build all network functions in one command</strong></p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">./build.sh
</code></pre></div></li>
</ol>
<h3 id="c-install-user-plane-function-upf">C. Install User Plane Function (UPF)</h3>
<ol>
<li>
<p>Please check Linux kernel version if it is <code>5.0.0-23-generic</code></p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">uname -r
</code></pre></div><p>Get Linux kernel module 5G GTP-U</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">git clone -b v0.1.0 https://github.com/PrinzOwO/gtp5g.git
<span style="color:#007020">cd</span> gtp5g
make
sudo make install
</code></pre></div></li>
<li>
<p>Build from sources</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash"><span style="color:#007020">cd</span> ~/free5gc/src/upf
mkdir build
<span style="color:#007020">cd</span> build
cmake ..
make -j<span style="color:#4070a0">`</span>nproc<span style="color:#4070a0">`</span>
</code></pre></div></li>
</ol>
<p><strong>Note: UPF&rsquo;s config is located at</strong> <code>free5gc/src/upf/build/config/upfcfg.yaml</code></p>


  

  
  <hr>
  <footer>

  
    <section>
    <h4></h4>
    <nav class="nav sharing-icons">
      <a class="nav-item" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ffree5gc.org%2finstallations%2fstage-3-installation%2f" title="Share on Facebook"><span class="fab fa-facebook-f fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2ffree5gc.org%2finstallations%2fstage-3-installation%2f" title="Share on LinkedIn"><span class="fab fa-linkedin-in fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://twitter.com/intent/tweet?url=https%3a%2f%2ffree5gc.org%2finstallations%2fstage-3-installation%2f&amp;text=" title="Tweet this"><span class="fab fa-twitter fa-2x"></span></a>
    </nav>
  </section>


  

  
  </footer>
  

</article> 



      
      <footer class="pt-4 my-md-5 pt-md-5 border-top">
        <div class="row">
          <div class="col-12 col-md">
	    <a href="https://free5gc.org"><img class="mb-2" src="/img/free5GC.png" alt="" height="32"></a>
            <small class="d-block mb-1 text-muted">&copy; Copyright January 2019 free5GC.org</small>
            <small class="d-block mb-1 text-muted">All rights reserved.</small>
          </div>
          <div class="col-6 col-md">
            <h5>Contact:</h5>
            <ul class="list-unstyled text-small">
              <li>
                <a class="link-secondary" href="mailto:free5GC.org@gmail.com"
                   target="_self"><span style="text-decoration:underline">free5GC.org@gmail.com</span>
                </a>
              </li>
            </ul>
          </div>
        </div>
      </footer>
      
    </div> <!-- /.container-fluid -->
  </body>

</html>

